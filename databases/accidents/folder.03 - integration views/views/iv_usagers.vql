CREATE OR REPLACE VIEW iv_usagers FOLDER = '/03 - integration views' AS SELECT bv_usagers.num_acc AS num_acc, bv_usagers.place AS place, case bv_usagers.sexe WHEN 1 THEN 'Masculin' WHEN 2 THEN 'Féminin' ELSE 'Inconnu' END AS sexe, bv_usagers.an_nais AS annee_naissance, bv_usagers.num_veh AS num_veh, bv_categorie_usager.description AS categorie_usager, bv_gravite.description AS gravite, bv_motif_deplacement.description AS motif_deplacement, case substr(secu, 1, 1) WHEN '1' THEN 'Ceinture' WHEN '2' THEN 'Casque' WHEN '3' THEN 'Dispositif enfants' WHEN '4' THEN 'Equipement réfléchissant' WHEN '9' THEN 'Autre' END AS equipement_securite, case substr(secu, 2, 1) WHEN '1' THEN 'Oui' WHEN '2' THEN 'Non' END AS presence_equipement, bv_localisation_pieton.description AS localisation_pieton, bv_localisation_pieton.regroupement AS localisation_pieton_groupe, bv_action_pieton.description AS action_pieton, bv_action_pieton.regroupement AS action_pieton_groupe, bv_groupe_pieton.description AS groupe_pieton FROM (((((bv_usagers AS bv_usagers INNER JOIN bv_categorie_usager AS bv_categorie_usager ON bv_usagers.catu = bv_categorie_usager.code ) INNER JOIN bv_gravite AS bv_gravite ON bv_usagers.grav = bv_gravite.code ) LEFT OUTER JOIN bv_motif_deplacement AS bv_motif_deplacement ON bv_usagers.trajet = bv_motif_deplacement.code ) LEFT OUTER JOIN bv_localisation_pieton AS bv_localisation_pieton ON bv_usagers.locp = bv_localisation_pieton.code ) LEFT OUTER JOIN bv_action_pieton AS bv_action_pieton ON bv_usagers.actp = bv_action_pieton.code ) LEFT OUTER JOIN bv_groupe_pieton AS bv_groupe_pieton ON bv_usagers.etatp = bv_groupe_pieton.code ;

ALTER VIEW iv_usagers
 LAYOUT (bv_usagers = [20, 20, 200, 225], bv_categorie_usager = [410, 20, 200, 66], bv_gravite = [470, 110, 200, 66], bv_motif_deplacement = [490, 200, 200, 66], bv_localisation_pieton = [470, 290, 200, 86], bv_action_pieton = [470, 400, 200, 86], bv_groupe_pieton = [330, 510, 200, 66]);

ALTER VIEW iv_usagers

    DECLARE CACHE INDEX idx_iv_usagers_num_acc ON (num_acc);

